---
layout: default
title: Kaikki
identifier: kaikki
preamble: Kaikki yhdessä siistissä paketissa
---

{% include tyyppitarkistus_habs.md %}

{% include tyyppitarkistus_virta.md %}

Muuttumattomuus tyyppiturvallisuuden apuvälineenä
-------------------------------------------------

Muuttumattomuutta (immutability) on luontevaa käyttää monenlaisissa tilanteissa. JavaScriptissä numerot ja merkkijonot ovat oletuksena muuttumattomia, mutta myös omista olioista voi tehdä muuttumattomia. Valmis ratkaisu löytyy `Object.freeze`-funktiosta. Se estää annetulle oliolle sekä kenttien lisäämisen että olemassaolevien kenttien muuttamisen. Tämä ei kuitenkaan estä yrittämistä, vaan jäädytetyn olion kentän muokkaaminen tai lisääminen epäonnistuu hiljaisesti.

Esimerkiksi ohjelmoinnin perusteista tuttu käteisen käsittely on luontevaa suorittaa muuttumattomilla olioilla, jotta operaatioita tehdessä ei vahingossa muuteta esimerkiksi jossain muualla tallessa olevaa Cash-oliota. Muuttumattomuudesta on hyötyä myös erityisesti nykyään niin trendikkäässä rinnakkaistamisessa.

    var Cash = function(euros, cents) {
        this.euros = euros;
        this.cents = cents;
        Object.freeze(this); // asettaa olion kentät muuttumattomiksi
    }
    
    var a = new Cash(4, 20);
    
    // prototyypin kautta voidaan kuitenkin lisätä esimerkiksi metodeja
    Cash.prototype.getTotalCents = function() { 
        return this.euros * 100 + this.cents 
    };
    Cash.prototype.toString = function() {
        return this.euros + "," + this.cents + "€";
    };
    
    // ei muuta arvoa
    a.euros = 10; 
    
    // "4,20€"
    write(a);
    
    // "a total of 420 cents"
    write("a total of " + a.getTotalCents() + " cents");
    
{% include errorit.md %}

{% include alogt-yms-virta.md %}

{% include periytyminen.md %}
    
{% include yhteenvetoa.md %}